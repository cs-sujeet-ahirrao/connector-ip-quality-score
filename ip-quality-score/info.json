{
  "name": "ip-quality-score",
  "label": "IP Quality Score",
  "description": "The IPQualityScore (IPQS) Threat Intelligence application provides threat intelligence for IP addresses, email addresses, URLs, and domains. This connector facilitates automated interactions with a IP Quality Score server using FortiSOARâ„¢ playbooks.",
  "publisher": "Community",
  "cs_approved": false,
  "cs_compatible": true,
  "version": "1.0.0",
  "category": "Threat Intelligence",
  "icon_small_name": "small.png",
  "icon_large_name": "large.png",
  "help_online": "",
  "configuration": {
    "fields": [
      {
        "title": "Server URL",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "text",
        "name": "server_url",
        "value": "https://ipqualityscore.com",
        "description": "The URL of the IPQualityScore server to which you will connect and perform the automated operations."
      },
      {
        "title": "Private Kay",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "password",
        "name": "password",
        "description": "The private key used to access the IPQualityScore server to which you will connect and perform the automated operations."
      },
      {
        "title": "Verify SSL",
        "required": false,
        "editable": true,
        "visible": true,
        "type": "checkbox",
        "name": "verify_ssl",
        "value": true,
        "description": "Specifies whether the SSL certificate for the server is to be verified or not. By default, this option is set as True."
      }
    ]
  },
  "operations": [
    {
      "operation": "get_ip_reputation",
      "title": "Get IP Reputation",
      "description": "Retrieves a report from IPQualityScore for the ip address submitted to determine if it is suspicious based on the ip address you have specified.",
      "category": "investigation",
      "annotation": "get_ip_reputation",
      "output_schema": {
        "success": "",
        "message": "",
        "fraud_score": "",
        "country_code": "",
        "region": "",
        "city": "",
        "ISP": "",
        "ASN": "",
        "organization": "",
        "is_crawler": "",
        "timezone": "",
        "mobile": "",
        "host": "",
        "proxy": "",
        "vpn": "",
        "tor": "",
        "active_vpn": "",
        "active_tor": "",
        "recent_abuse": "",
        "bot_status": "",
        "connection_type": "",
        "abuse_velocity": "",
        "zip_code": "",
        "latitude": "",
        "longitude": "",
        "request_id": ""
      },
      "parameters": [
        {
          "title": "IP Address",
          "name": "ip_address",
          "visible": true,
          "required": true,
          "editable": true,
          "type": "text",
          "tooltip": "Specify the IP address, whose IP reputation you want to retrieve from IPQualityScore",
          "description": "Specify the IP address, whose IP reputation you want to retrieve from IPQualityScore."
        },
        {
          "title": "Strictness",
          "name": "strictness",
          "visible": true,
          "required": false,
          "editable": true,
          "options": [
            "0",
            "1",
            "2",
            "3"
          ],
          "value": [
            "0"
          ],
          "tooltip": "Stricter checks may provide a higher false-positive rate. We recommend defaulting to level \"0\", the lowest strictness setting, and increasing to \"1\" or \"2\" depending on your levels of fraud.",
          "description": "Stricter checks may provide a higher false-positive rate. We recommend defaulting to level \"0\", the lowest strictness setting, and increasing to \"1\" or \"2\" depending on your levels of fraud."
        },
        {
          "title": "User Agent",
          "name": "user_agent",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "text",
          "tooltip": "This allows IPQualityScore to run additional checks to see if the user is a bot or running an invalid browser. This allows IPQualityScore to evaluate the risk of the user as judged in the \"fraud_score\".",
          "description": "This allows IPQualityScore to run additional checks to see if the user is a bot or running an invalid browser. This allows IPQualityScore to evaluate the risk of the user as judged in the \"fraud_score\"."
        },
        {
          "title": "User Language",
          "name": "user_language",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "text",
          "tooltip": "This allows IPQualityScore to evaluate the risk of the user as judged in the \"fraud_score\".",
          "description": "This allows IPQualityScore to evaluate the risk of the user as judged in the \"fraud_score\"."
        },
        {
          "title": "Fast",
          "name": "fast",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "checkbox",
          "value": false,
          "tooltip": "When this parameter is enabled our API will not perform certain forensic checks that take longer to process. Enabling this feature greatly increases the API speed without much impact on accuracy. This option is intended for services that require decision making in a time sensitive manner and can be used for any strictness level.",
          "description": "When this parameter is enabled our API will not perform certain forensic checks that take longer to process. Enabling this feature greatly increases the API speed without much impact on accuracy. This option is intended for services that require decision making in a time sensitive manner and can be used for any strictness level."
        },
        {
          "title": "Mobile",
          "name": "mobile",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "checkbox",
          "value": false,
          "tooltip": "Recommended for mobile lookups that do not have a user agent attached to the request.",
          "description": "Recommended for mobile lookups that do not have a user agent attached to the request."
        },
        {
          "title": "Allow Public Access Points",
          "name": "allow_public_access_points",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "checkbox",
          "value": false,
          "tooltip": "Bypasses certain checks for IP addresses from education and research institutions, schools, and some corporate connections to better accommodate audiences that frequently use public connections.",
          "description": "Bypasses certain checks for IP addresses from education and research institutions, schools, and some corporate connections to better accommodate audiences that frequently use public connections."
        },
        {
          "title": "Lighter Penalties",
          "name": "lighter_penalties",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "checkbox",
          "value": false,
          "tooltip": "Is your scoring too strict? Enable this setting to lower detection rates and Fraud Scores for mixed quality IP addresses. If you experience any false-positives with your traffic then enabling this feature will provide better results.",
          "description": "Is your scoring too strict? Enable this setting to lower detection rates and Fraud Scores for mixed quality IP addresses. If you experience any false-positives with your traffic then enabling this feature will provide better results."
        },
        {
          "title": "Transaction Strictness",
          "name": "transaction_strictness",
          "visible": true,
          "required": false,
          "editable": true,
          "options": [
            "0",
            "1",
            "2"
          ],
          "value": [
            "0"
          ],
          "tooltip": "Adjusts the weights for penalties applied due to irregularities and fraudulent patterns detected on order and transaction details that can be optionally provided on each API request. This feature is only beneficial if you are passing order and transaction details.",
          "description": "Adjusts the weights for penalties applied due to irregularities and fraudulent patterns detected on order and transaction details that can be optionally provided on each API request. This feature is only beneficial if you are passing order and transaction details."
        }
      ],
      "enabled": true
    },
    {
      "operation": "get_email_reputation",
      "title": "Get Email Reputation",
      "description": "Retrieves a report from IPQualityScore for the Email address submitted to determine if it is suspicious based on the Email address you have specified.",
      "category": "investigation",
      "annotation": "get_email_reputation",
      "output_schema": {
        "message": "",
        "success": "",
        "valid": "",
        "disposable": "",
        "smtp_score": "",
        "overall_score": "",
        "first_name": "",
        "generic": "",
        "common": "",
        "dns_valid": "",
        "honeypot": "",
        "deliverability": "",
        "frequent_complainer": "",
        "spam_trap_score": "",
        "catch_all": "",
        "timed_out": "",
        "suspect": "",
        "recent_abuse": "",
        "fraud_score": "",
        "suggested_domain": "",
        "leaked": "",
        "domain_age": {
          "human": "",
          "timestamp": "",
          "iso": ""
        },
        "first_seen": {
          "human": "",
          "timestamp": "",
          "iso": ""
        },
        "sanitized_email": "",
        "domain_velocity": "",
        "user_activity": "",
        "associated_names": {
          "status": "",
          "names": []
        },
        "associated_phone_numbers": {
          "status": "",
          "phone_numbers": []
        },
        "request_id": ""
      },
      "parameters": [
        {
          "title": "Email Address",
          "name": "email_address",
          "visible": true,
          "required": true,
          "editable": true,
          "type": "text",
          "tooltip": "Specify the Email address, whose email reputation you want to retrieve from IPQualityScore",
          "description": "Specify the Email address, whose email reputation you want to retrieve from IPQualityScore."
        },
        {
          "title": "Fast",
          "name": "fast",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "checkbox",
          "value": false,
          "tooltip": "When this parameter is enabled our API will not perform an SMTP check with the mail service provider, which greatly increases the API speed. ",
          "description": "When this parameter is enabled our API will not perform an SMTP check with the mail service provider, which greatly increases the API speed. "
        },
        {
          "title": "Timeout",
          "name": "timeout",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "integer",
          "value": 7,
          "tooltip": "Provides better accuracy if response time is not an issue, timeout can be a value between 1 and 60. Default timeout is 7 seconds.",
          "description": "Provides better accuracy if response time is not an issue, timeout can be a value between 1 and 60. Default timeout is 7 seconds."
        },
        {
          "title": "Suggest Domain",
          "name": "suggest_domain",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "checkbox",
          "value": false,
          "tooltip": "Force analyze if the email address's domain has a typo and should be corrected to a popular mail service. By default, this test is currently only performed when the email is invalid or if the \"recent abuse\" status is true.",
          "description": "Force analyze if the email address's domain has a typo and should be corrected to a popular mail service. By default, this test is currently only performed when the email is invalid or if the \"recent abuse\" status is true."
        },
        {
          "title": "Strictness",
          "name": "strictness",
          "visible": true,
          "required": false,
          "editable": true,
          "options": [
            "0",
            "1",
            "2"
          ],
          "value": [
            "0"
          ],
          "type": "text",
          "tooltip": "Sets how strictly spam traps and honeypots are detected by our system, depending on how comfortable you are with identifying emails suspected of being a spam trap. 0 is the lowest level which will only return spam traps with high confidence. Strictness levels above 0 will return increasingly more strict results, with level 2 providing the greatest detection rates.",
          "description": "Sets how strictly spam traps and honeypots are detected by our system, depending on how comfortable you are with identifying emails suspected of being a spam trap. 0 is the lowest level which will only return spam traps with high confidence. Strictness levels above 0 will return increasingly more strict results, with level 2 providing the greatest detection rates."
        },
        {
          "title": "Abuse Strictness",
          "name": "abuse_strictness",
          "visible": true,
          "required": false,
          "editable": true,
          "options": [
            "0",
            "1",
            "2"
          ],
          "value": [
            "0"
          ],
          "type": "text",
          "tooltip": "Set the strictness level for machine learning pattern recognition of abusive email addresses with the \"recent_abuse\" data point. Default level of 0 provides good coverage, however if you are filtering account applications and facing advanced fraudsters then we recommend increasing this value to level 1 or 2.",
          "description": "Set the strictness level for machine learning pattern recognition of abusive email addresses with the \"recent_abuse\" data point. Default level of 0 provides good coverage, however if you are filtering account applications and facing advanced fraudsters then we recommend increasing this value to level 1 or 2."
        }
      ],
      "enabled": true
    },
    {
      "operation": "get_url_reputation",
      "title": "Get URL Reputation",
      "description": "Retrieves a report from IPQualityScore for the URL submitted to determine if it is suspicious based on the URL you have specified.",
      "category": "investigation",
      "annotation": "get_url_reputation",
      "output_schema": {
        "message": "",
        "success": "",
        "unsafe": "",
        "domain": "",
        "ip_address": "",
        "server": "",
        "content_type": "",
        "status_code": "",
        "page_size": "",
        "domain_rank": "",
        "dns_valid": "",
        "parking": "",
        "spamming": "",
        "malware": "",
        "phishing": "",
        "suspicious": "",
        "adult": "",
        "risk_score": "",
        "category": "",
        "domain_age": {
          "human": "",
          "timestamp": "",
          "iso": ""
        },
        "request_id": ""
      },
      "parameters": [
        {
          "title": "URL",
          "name": "url",
          "visible": true,
          "required": true,
          "editable": true,
          "type": "text",
          "tooltip": "Specify the url, whose url reputation you want to retrieve from IPQualityScore.",
          "description": "Specify the url, whose url reputation you want to retrieve from IPQualityScore."
        },
        {
          "title": "Strictness",
          "name": "strictness",
          "visible": true,
          "required": false,
          "editable": true,
          "options": [
            "0",
            "1",
            "2"
          ],
          "value": [
            "0"
          ],
          "type": "text",
          "tooltip": "Stricter checks may provide a higher false-positive rate. We recommend defaulting to level \"0\", the lowest strictness setting, and increasing to \"1\" or \"2\" depending on your levels of abuse.",
          "description": "Stricter checks may provide a higher false-positive rate. We recommend defaulting to level \"0\", the lowest strictness setting, and increasing to \"1\" or \"2\" depending on your levels of abuse."
        },
        {
          "title": "Fast",
          "name": "fast",
          "visible": true,
          "required": false,
          "editable": true,
          "type": "checkbox",
          "value": false,
          "tooltip": "When enabled, the API will provide quicker response times using lighter checks and analysis. This setting defaults to false.",
          "description": "When enabled, the API will provide quicker response times using lighter checks and analysis. This setting defaults to false."
        }
      ],
      "enabled": true
    }
  ]
}
